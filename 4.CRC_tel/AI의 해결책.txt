AI의 해결책

권장 통신 설계 (우선순위)
- 프레임: Start(0xAA)  Ver  MsgType  Seq  Len  Payload  CRC16. 이진 포맷으로 고정 길이/스케일 사용(예: 서보 각도 1바이트). CRC16로 무결성 검사 후 ACK/NAK 처리(재전송 3회, 타임아웃 150ms).
- 역할 분리:
- PC→ESP32 (UDP 포트 8888): 목적지 지시, 분기/경로 지시, 긴급정지(우선 처리).
- ESP32→PC (UDP 응답): ACK/상태/이미지 전송 요청(이미지는 TCP로 전송).
- ESP32↔Arduino (SPI): 명령 전달은 SPI(1–4MHz 권장), CS로 동기화, 레벨시프터 사용. ESP32는 Master로 SPI 설정 가능(핀 커스터마이즈 가능).
- 예외 처리: 장애물/분기 발생 시 ESP32는 즉시 정지 후 이미지+현재 시점을 TCP로 PC에 업로드하여 경로결정 요청.
- 보안·안정성: 네트워크가 불안하면 메시지에 타임스탬프·시퀀스·HMAC(선택) 추가.
