# TargetA êµ¬í˜„ ë°©ì‹ ë¹„êµ ë¶„ì„

## ğŸ“Š **ë°©ë²• 1: Coil ì½ê¸° ê¸°ëŠ¥ ì¶”ê°€ (FC 0x01)**

### êµ¬í˜„ ë‚´ìš©
```cpp
case 0x01: { // Read Coils (NEW)
  uint16_t coilAddr = (request[8] << 8) | request[9];
  uint16_t quantity = (request[10] << 8) | request[11];
  
  if (coilAddr == 7) {  // TargetA coil 00007
    bool value = getBooleanBit(holdingRegisters[REG_TARGET_A], 0);
    // Coil ìƒíƒœ ë°˜í™˜
  }
}

case 0x05: { // Write Single Coil (ê¸°ì¡´)
  if (coilAddr == 7) {
    bool value = (coilValue == 0xFF00);
    setBooleanBit(&holdingRegisters[REG_TARGET_A], 0, value);
  }
}
```

### ì¥ì  âœ…
| í•­ëª© | ì„¤ëª… |
|------|------|
| **Modbus í‘œì¤€** | Coilì€ Boolean íƒ€ì…ì˜ ì •ì¤€(canonical) ì£¼ì†Œ |
| **KEPware í˜¸í™˜** | OPC Coil ê°œë…ê³¼ 1:1 ë§¤ì¹­ |
| **êµ¬ì¡° ëª…í™•** | Coil â†” Boolean, Register â†” Numeric ëª…í™•í•œ êµ¬ë¶„ |
| **í–¥í›„ í™•ì¥** | ë‹¤ë¥¸ Boolean íƒœê·¸ ì¶”ê°€ ì‹œ íŒ¨í„´ ì¬ì‚¬ìš© ê°€ëŠ¥ |
| **ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨** | 1 ë¹„íŠ¸ë§Œ ì „ì†¡ (ë” ì‘ì€ ë°ì´í„°) |

### ë‹¨ì  âŒ
| í•­ëª© | ì„¤ëª… |
|------|------|
| **ë³µì¡ë„** | ë‘ ê°€ì§€ í•¨ìˆ˜ ì½”ë“œ ê´€ë¦¬ í•„ìš” (0x01, 0x05) |
| **ì½”ë“œëŸ‰** | ì¶”ê°€ êµ¬í˜„ í•„ìš” (~30ì¤„) |
| **ë©”ëª¨ë¦¬** | ì•½ê°„ì˜ ì¶”ê°€ ROM ì‚¬ìš© |

### ì½”ë“œ ë³€ê²½ ìœ„ì¹˜
```
processModbusRequest() í•¨ìˆ˜
  â”œâ”€ case 0x01: ì¶”ê°€ (ìƒˆë¡œ ì‘ì„±)
  â”œâ”€ case 0x05: ê¸°ì¡´ ìœ ì§€
  â””â”€ ì´ ì½”ë“œëŸ‰: +30ì¤„
```

### KEPware ì„¤ì •
```
Tag: TargetA
â”œâ”€ Type: Boolean
â”œâ”€ Address: 00007
â””â”€ Device: Modbus TCP
    â””â”€ Function Code: 1 (Read) & 5 (Write)
```

---

## ğŸ“Š **ë°©ë²• 2: TargetAë¥¼ í™€ë”© ë ˆì§€ìŠ¤í„°ë¡œ ë³€ê²½**

### êµ¬í˜„ ë‚´ìš©
```cpp
// holdingRegisters[7]ì— ì €ì¥ (Coil ëŒ€ì‹ )
REG_TARGET_A = 7,  // 40008 (ë³€ê²½ ì „: 40007)

// ì½ê¸°: FC 0x03 (ê¸°ì¡´ ë™ì‘)
case 0x03: { // Read Holding Registers
  // holdingRegisters[7] ì½ìŒ âœ“
}

// ì“°ê¸°: FC 0x06 (ê¸°ì¡´ ë™ì‘)
case 0x06: { // Write Single Register
  holdingRegisters[7] = regValue;  // TargetA ì„¤ì •
}

// Coil ì²˜ë¦¬ ì œê±°
case 0x05: { // ì‚­ì œ ê°€ëŠ¥
  // (ë” ì´ìƒ í•„ìš” ì—†ìŒ)
}
```

### ì¥ì  âœ…
| í•­ëª© | ì„¤ëª… |
|------|------|
| **ë‹¨ìˆœì„±** | FC 0x03, 0x06ë§Œ ì‚¬ìš© (ì´ë¯¸ êµ¬í˜„ë¨) |
| **ì½”ë“œ ìµœì†Œ** | ê¸°ì¡´ ì½”ë“œ ìˆ˜ì •ë§Œ í•„ìš” (~10ì¤„) |
| **ë¹ ë¥¸ êµ¬í˜„** | ì¦‰ì‹œ ì ìš© ê°€ëŠ¥ |
| **ë©”ëª¨ë¦¬ ì ˆì•½** | ì¶”ê°€ ì½”ë“œ ê±°ì˜ ì—†ìŒ |
| **ì¼ê´€ì„±** | ëª¨ë“  ë°ì´í„°ê°€ holdingRegisters ì‚¬ìš© |

### ë‹¨ì  âŒ
| í•­ëª© | ì„¤ëª… |
|------|------|
| **Modbus ë¹„í‘œì¤€** | Booleanì„ Registerë¡œ ì €ì¥ (ë¶€ìì—°ìŠ¤ëŸ¬ì›€) |
| **ë°ì´í„° ë‚­ë¹„** | 1ë¹„íŠ¸ ê°’ì„ 16ë¹„íŠ¸ ë ˆì§€ìŠ¤í„°ì— ì €ì¥ |
| **ë„¤íŠ¸ì›Œí¬ ë¹„íš¨ìœ¨** | 15ë¹„íŠ¸ ë‚­ë¹„ |
| **ê°œë… í˜¼ë™** | Coilê³¼ Registerì˜ ê²½ê³„ê°€ ëª¨í˜¸í•¨ |
| **í˜¸í™˜ì„±** | ë‹¤ë¥¸ SCADA/HMI ì‹œìŠ¤í…œê³¼ í˜¸í™˜ ë¬¸ì œ ê°€ëŠ¥ |

### ì½”ë“œ ë³€ê²½ ìœ„ì¹˜
```
processModbusRequest() í•¨ìˆ˜
  â”œâ”€ case 0x05: ì œê±° ë˜ëŠ” ì£¼ì„ì²˜ë¦¬
  â”œâ”€ case 0x03: ìˆ˜ì • ì•ˆ í•¨ (ìë™ìœ¼ë¡œ ì‘ë™)
  â”œâ”€ case 0x06: ìˆ˜ì • ì•ˆ í•¨ (ìë™ìœ¼ë¡œ ì‘ë™)
  â””â”€ ì´ ì½”ë“œëŸ‰: -20ì¤„
```

### KEPware ì„¤ì •
```
Tag: TargetA
â”œâ”€ Type: UInt16 ë˜ëŠ” Boolean (Emulated)
â”œâ”€ Address: 40008
â””â”€ Device: Modbus TCP
    â””â”€ Function Code: 3 (Read) & 6 (Write)
```

---

## ğŸ”„ **ìƒì„¸ ë¹„êµ**

### ë°ì´í„° íë¦„ ë¹„êµ

#### ë°©ë²• 1: Coil
```
KEPware (Coil 00007)
  â†“ FC 0x01 (Read Coils)
ESP32: processModbusRequest()
  â”œâ”€ case 0x01:
  â”‚   â””â”€ holdingRegisters[6] bit0 ì½ìŒ
  â””â”€ ì‘ë‹µ: 0xFF00 (ON) ë˜ëŠ” 0x0000 (OFF)
  â†“
KEPware: TargetA = 1 (ë˜ëŠ” 0)
```

#### ë°©ë²• 2: Register
```
KEPware (Register 40008)
  â†“ FC 0x03 (Read Holding Registers)
ESP32: processModbusRequest()
  â”œâ”€ case 0x03:
  â”‚   â””â”€ holdingRegisters[7] ì½ìŒ
  â””â”€ ì‘ë‹µ: 0x0001 (ON) ë˜ëŠ” 0x0000 (OFF)
  â†“
KEPware: TargetA = 1 (ë˜ëŠ” 0)
```

---

### ì„±ëŠ¥ ë¹„êµ

| í•­ëª© | ë°©ë²• 1 (Coil) | ë°©ë²• 2 (Register) |
|------|-------------|-----------------|
| **ì‘ë‹µ ì‹œê°„** | ~50ms | ~50ms (ë™ì¼) |
| **ë„¤íŠ¸ì›Œí¬ ëŒ€ì—­í­** | 1 bit | 16 bits (16ë°° ë‚­ë¹„) |
| **ë©”ëª¨ë¦¬ (ROM)** | +30ì¤„ | -20ì¤„ |
| **ë©”ëª¨ë¦¬ (RAM)** | ë™ì¼ | ë™ì¼ |
| **êµ¬í˜„ ë‚œë„** | ì¤‘ê°„ | ë‚®ìŒ |
| **í‘œì¤€ ì¤€ìˆ˜** | âœ… ì™„ë²½ | âŒ ë¹„í‘œì¤€ |

---

### ë ˆì§€ìŠ¤í„° ì£¼ì†Œ ë³€ê²½

#### ë°©ë²• 1 (Coil ìœ ì§€)
```
í˜„ì¬:
  40007.0 (Holding Register) + Coil 00007
  
ìœ ì§€:
  40007.0 (Holding Register) + Coil 00007
  
ë³€ê²½ ì—†ìŒ
```

#### ë°©ë²• 2 (Registerë¡œ í†µí•©)
```
ë³€ê²½ ì „:
  REG_TARGET_A = 6  // 40007.0 (Holding Register)
  Coil 00007        // (ì½ê¸° ë¶ˆê°€)
  
ë³€ê²½ í›„:
  REG_TARGET_A = 7  // 40008 (Holding Register)
  Coil 00007        // ì œê±°
  
ì£¼ì†Œ ë³€ê²½: 40007 â†’ 40008 (KEPware ì„¤ì • ìˆ˜ì • í•„ìš”)
```

---

## ğŸ¯ **ê¶Œì¥ ì‚¬í•­**

### âœ… **ë°©ë²• 1 ì¶”ì²œ ì´ìœ **
```
ì¥ê¸°ì  ê´€ì ì—ì„œ ì´ìƒì :
âœ“ Modbus í‘œì¤€ ì¤€ìˆ˜
âœ“ SCADA í˜¸í™˜ì„± ë†’ìŒ
âœ“ ì „ë¬¸ì ì¸ êµ¬í˜„
âœ“ í–¥í›„ í™•ì¥ì„± ìš°ìˆ˜
âœ“ ì—…ê³„ í‘œì¤€ ë°©ì‹

ì ìš© ìƒí™©:
- í”„ë¡œë•ì…˜ ì‹œìŠ¤í…œ
- ì¥ê¸° ìœ ì§€ë³´ìˆ˜ í•„ìš”
- ë‹¤ì–‘í•œ HMI ì—°ë™
```

### âœ… **ë°©ë²• 2 ì¶”ì²œ ì´ìœ **
```
ê°œë°œ ì†ë„ ìš°ì„ :
âœ“ ë¹ ë¥¸ êµ¬í˜„
âœ“ ê°„ë‹¨í•œ ì½”ë“œ
âœ“ í˜„ì¬ êµ¬ì¡°ì™€ í˜¸í™˜
âœ“ í…ŒìŠ¤íŠ¸ ìš©ì´

ì ìš© ìƒí™©:
- í”„ë¡œí† íƒ€ì…/í…ŒìŠ¤íŠ¸
- ë¹ ë¥¸ ê²€ì¦ í•„ìš”
- ì„ì‹œ ì†”ë£¨ì…˜
```

---

## ğŸ“‹ **ìµœì¢… ì„ íƒ ê¸°ì¤€**

### ì„ íƒ í”Œë¡œìš°ì°¨íŠ¸

```
Q1: ì¥ê¸°ì ìœ¼ë¡œ ì‚¬ìš©í•  ì‹œìŠ¤í…œì¸ê°€?
  â”œâ”€ YES â†’ ë°©ë²• 1 (Coil)
  â””â”€ NO  â†’ ë°©ë²• 2 (Register)

Q2: ë‹¤ì–‘í•œ HMI/SCADAì™€ ì—°ë™í•  ì˜ˆì •?
  â”œâ”€ YES â†’ ë°©ë²• 1 (Coil)
  â””â”€ NO  â†’ ë°©ë²• 2 (Register)

Q3: ë¹ ë¥¸ êµ¬í˜„ì´ ìµœìš°ì„ ?
  â”œâ”€ YES â†’ ë°©ë²• 2 (Register)
  â””â”€ NO  â†’ ë°©ë²• 1 (Coil)
```

---

## ğŸ“ **ê²°ë¡ **

| ê¸°ì¤€ | ë°©ë²• 1 | ë°©ë²• 2 |
|------|--------|--------|
| **ë‚œë„**   | â­â­â­ | â­ |
| **í‘œì¤€ì„±** | â­â­â­â­â­ | â­â­ |
| **í˜¸í™˜ì„±** | â­â­â­â­â­ | â­â­â­ |
| **íš¨ìœ¨ì„±** | â­â­â­â­â­ | â­â­â­ |
| **êµ¬í˜„ì‹œê°„** | ì¤‘ê°„ | ë¹ ë¦„ |
| **ìœ ì§€ë³´ìˆ˜** | ìš°ìˆ˜ | ì–‘í˜¸ |

**ì¶”ì²œ**: ğŸ† **ë°©ë²• 1 (Coil ì½ê¸°)** - í”„ë¡œë•ì…˜ ì‹œìŠ¤í…œìœ¼ë¡œ ì í•©
